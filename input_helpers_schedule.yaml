# =============================================================================
# HEATING SCHEDULE INPUT HELPERS CONFIGURATION
# Copy this content to your Home Assistant configuration.yaml
#
# Based on your existing schedule structure with 6 rooms:
# - T_lukas_park
# - T_lukas_kirche
# - T_lukas_schillerstr
# - T_kueche
# - T_philip
# - T_guest
# =============================================================================

# Global schedule control
input_boolean:
  heat_schedule_enabled:
    name: "Heat Schedule Enabled"
    icon: mdi:thermostat

  # Daily schedule toggles
  heat_schedule_monday_active:
    name: "Monday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_tuesday_active:
    name: "Tuesday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_wednesday_active:
    name: "Wednesday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_thursday_active:
    name: "Thursday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_friday_active:
    name: "Friday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_saturday_active:
    name: "Saturday Schedule Active"
    icon: mdi:calendar-today
  heat_schedule_sunday_active:
    name: "Sunday Schedule Active"
    icon: mdi:calendar-today

# =============================================================================
# TIME PERIODS - Monday through Friday (Weekdays)
# =============================================================================
input_datetime:
  # Period 1: 00:00 - 07:00
  heat_weekday_period1_start:
    name: "Weekday Period 1 Start"
    has_date: false
    has_time: true
    initial: "00:00:00"
  heat_weekday_period1_end:
    name: "Weekday Period 1 End"
    has_date: false
    has_time: true
    initial: "07:00:00"

  # Period 2: 07:00 - 09:30
  heat_weekday_period2_start:
    name: "Weekday Period 2 Start"
    has_date: false
    has_time: true
    initial: "07:00:00"
  heat_weekday_period2_end:
    name: "Weekday Period 2 End"
    has_date: false
    has_time: true
    initial: "09:30:00"

  # Period 3: 09:30 - 14:30
  heat_weekday_period3_start:
    name: "Weekday Period 3 Start"
    has_date: false
    has_time: true
    initial: "09:30:00"
  heat_weekday_period3_end:
    name: "Weekday Period 3 End"
    has_date: false
    has_time: true
    initial: "14:30:00"

  # Period 4: 14:30 - 21:00
  heat_weekday_period4_start:
    name: "Weekday Period 4 Start"
    has_date: false
    has_time: true
    initial: "14:30:00"
  heat_weekday_period4_end:
    name: "Weekday Period 4 End"
    has_date: false
    has_time: true
    initial: "21:00:00"

  # Period 5: 21:00 - 23:00
  heat_weekday_period5_start:
    name: "Weekday Period 5 Start"
    has_date: false
    has_time: true
    initial: "21:00:00"
  heat_weekday_period5_end:
    name: "Weekday Period 5 End"
    has_date: false
    has_time: true
    initial: "23:00:00"

  # Period 6: 23:00 - 24:00 (Tuesday has 23:59:59, others 24:00:00)
  heat_weekday_period6_start:
    name: "Weekday Period 6 Start"
    has_date: false
    has_time: true
    initial: "23:00:00"
  heat_weekday_period6_end:
    name: "Weekday Period 6 End"
    has_date: false
    has_time: true
    initial: "23:59:59"

  # =============================================================================
  # TIME PERIODS - Friday (Slightly different schedule)
  # =============================================================================
  # Friday Period 5: 21:00 - 23:00 (same temperature as weekday period 4)
  heat_friday_period5_start:
    name: "Friday Period 5 Start"
    has_date: false
    has_time: true
    initial: "21:00:00"
  heat_friday_period5_end:
    name: "Friday Period 5 End"
    has_date: false
    has_time: true
    initial: "23:00:00"

  # =============================================================================
  # TIME PERIODS - Weekend (Saturday & Sunday)
  # =============================================================================
  # Period 1: 00:00 - 07:30
  heat_weekend_period1_start:
    name: "Weekend Period 1 Start"
    has_date: false
    has_time: true
    initial: "00:00:00"
  heat_weekend_period1_end:
    name: "Weekend Period 1 End"
    has_date: false
    has_time: true
    initial: "07:30:00"

  # Period 2: 07:30 - 10:30
  heat_weekend_period2_start:
    name: "Weekend Period 2 Start"
    has_date: false
    has_time: true
    initial: "07:30:00"
  heat_weekend_period2_end:
    name: "Weekend Period 2 End"
    has_date: false
    has_time: true
    initial: "10:30:00"

  # Period 3: 10:30 - 19:00
  heat_weekend_period3_start:
    name: "Weekend Period 3 Start"
    has_date: false
    has_time: true
    initial: "10:30:00"
  heat_weekend_period3_end:
    name: "Weekend Period 3 End"
    has_date: false
    has_time: true
    initial: "19:00:00"

  # Period 4: 19:00 - 23:00
  heat_weekend_period4_start:
    name: "Weekend Period 4 Start"
    has_date: false
    has_time: true
    initial: "19:00:00"
  heat_weekend_period4_end:
    name: "Weekend Period 4 End"
    has_date: false
    has_time: true
    initial: "23:00:00"

  # Period 5: 23:00 - 23:59:59
  heat_weekend_period5_start:
    name: "Weekend Period 5 Start"
    has_date: false
    has_time: true
    initial: "23:00:00"
  heat_weekend_period5_end:
    name: "Weekend Period 5 End"
    has_date: false
    has_time: true
    initial: "23:59:59"

# =============================================================================
# TEMPERATURE VALUES
# =============================================================================
input_number:
  # =============================================================================
  # WEEKDAY TEMPERATURES (Monday-Thursday)
  # =============================================================================

  # Period 1: 00:00-07:00 - All rooms 5°C
  heat_weekday_period1_lukas_park:
    name: "Weekday Period 1 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period1_lukas_kirche:
    name: "Weekday Period 1 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period1_lukas_schillerstr:
    name: "Weekday Period 1 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period1_kueche:
    name: "Weekday Period 1 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period1_philip:
    name: "Weekday Period 1 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period1_guest:
    name: "Weekday Period 1 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 2: 07:00-09:30 - Most rooms 21°C, Guest 20°C
  heat_weekday_period2_lukas_park:
    name: "Weekday Period 2 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period2_lukas_kirche:
    name: "Weekday Period 2 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period2_lukas_schillerstr:
    name: "Weekday Period 2 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period2_kueche:
    name: "Weekday Period 2 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period2_philip:
    name: "Weekday Period 2 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period2_guest:
    name: "Weekday Period 2 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 3: 09:30-14:30 - Most rooms 21°C, Guest 20°C
  heat_weekday_period3_lukas_park:
    name: "Weekday Period 3 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period3_lukas_kirche:
    name: "Weekday Period 3 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period3_lukas_schillerstr:
    name: "Weekday Period 3 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period3_kueche:
    name: "Weekday Period 3 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period3_philip:
    name: "Weekday Period 3 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period3_guest:
    name: "Weekday Period 3 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 4: 14:30-21:00 - Most rooms 21°C, Guest 20°C
  heat_weekday_period4_lukas_park:
    name: "Weekday Period 4 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period4_lukas_kirche:
    name: "Weekday Period 4 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period4_lukas_schillerstr:
    name: "Weekday Period 4 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period4_kueche:
    name: "Weekday Period 4 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period4_philip:
    name: "Weekday Period 4 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period4_guest:
    name: "Weekday Period 4 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 5: 21:00-23:00 - Most rooms 21.5°C, Guest 20°C
  heat_weekday_period5_lukas_park:
    name: "Weekday Period 5 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period5_lukas_kirche:
    name: "Weekday Period 5 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period5_lukas_schillerstr:
    name: "Weekday Period 5 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period5_kueche:
    name: "Weekday Period 5 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period5_philip:
    name: "Weekday Period 5 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period5_guest:
    name: "Weekday Period 5 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 6: 23:00-24:00 - All rooms 5°C
  heat_weekday_period6_lukas_park:
    name: "Weekday Period 6 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period6_lukas_kirche:
    name: "Weekday Period 6 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period6_lukas_schillerstr:
    name: "Weekday Period 6 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period6_kueche:
    name: "Weekday Period 6 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period6_philip:
    name: "Weekday Period 6 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekday_period6_guest:
    name: "Weekday Period 6 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # =============================================================================
  # FRIDAY TEMPERATURES (Slightly different - Period 5 is same as Period 4)
  # =============================================================================

  # Friday Period 5: 21:00-23:00 - Most rooms 21°C (not 21.5°C), Guest 20°C
  heat_friday_period5_lukas_park:
    name: "Friday Period 5 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_friday_period5_lukas_kirche:
    name: "Friday Period 5 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_friday_period5_lukas_schillerstr:
    name: "Friday Period 5 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_friday_period5_kueche:
    name: "Friday Period 5 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_friday_period5_philip:
    name: "Friday Period 5 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_friday_period5_guest:
    name: "Friday Period 5 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # =============================================================================
  # WEEKEND TEMPERATURES (Saturday & Sunday)
  # =============================================================================

  # Period 1: 00:00-07:30 - All rooms 5°C
  heat_weekend_period1_lukas_park:
    name: "Weekend Period 1 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period1_lukas_kirche:
    name: "Weekend Period 1 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period1_lukas_schillerstr:
    name: "Weekend Period 1 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period1_kueche:
    name: "Weekend Period 1 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period1_philip:
    name: "Weekend Period 1 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period1_guest:
    name: "Weekend Period 1 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 2: 07:30-10:30 - Most rooms 21°C, Guest 20°C
  heat_weekend_period2_lukas_park:
    name: "Weekend Period 2 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period2_lukas_kirche:
    name: "Weekend Period 2 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period2_lukas_schillerstr:
    name: "Weekend Period 2 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period2_kueche:
    name: "Weekend Period 2 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period2_philip:
    name: "Weekend Period 2 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period2_guest:
    name: "Weekend Period 2 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 3: 10:30-19:00 - Most rooms 21°C, Guest 20°C
  heat_weekend_period3_lukas_park:
    name: "Weekend Period 3 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period3_lukas_kirche:
    name: "Weekend Period 3 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period3_lukas_schillerstr:
    name: "Weekend Period 3 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period3_kueche:
    name: "Weekend Period 3 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period3_philip:
    name: "Weekend Period 3 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period3_guest:
    name: "Weekend Period 3 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 4: 19:00-23:00 - Most rooms 21.5°C, Guest 20°C
  heat_weekend_period4_lukas_park:
    name: "Weekend Period 4 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period4_lukas_kirche:
    name: "Weekend Period 4 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period4_lukas_schillerstr:
    name: "Weekend Period 4 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period4_kueche:
    name: "Weekend Period 4 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period4_philip:
    name: "Weekend Period 4 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 21.5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period4_guest:
    name: "Weekend Period 4 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 20
    unit_of_measurement: "°C"
    icon: mdi:thermometer

  # Period 5: 23:00-23:59:59 - All rooms 5°C
  heat_weekend_period5_lukas_park:
    name: "Weekend Period 5 - Lukas Park"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period5_lukas_kirche:
    name: "Weekend Period 5 - Lukas Kirche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period5_lukas_schillerstr:
    name: "Weekend Period 5 - Lukas Schillerstr"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period5_kueche:
    name: "Weekend Period 5 - Küche"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period5_philip:
    name: "Weekend Period 5 - Philip"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer
  heat_weekend_period5_guest:
    name: "Weekend Period 5 - Guest"
    min: 5
    max: 30
    step: 0.5
    initial: 5
    unit_of_measurement: "°C"
    icon: mdi:thermometer

# =============================================================================
# TEMPLATE SENSORS FOR CURRENT SCHEDULE EVALUATION
# =============================================================================
template:
  - binary_sensor:
      - name: "Heat Schedule Active Now"
        unique_id: heat_schedule_active_now
        state: >
          {% set enabled = is_state('input_boolean.heat_schedule_enabled', 'on') %}
          {% if not enabled %}
            false
          {% else %}
            {% set wd = now().weekday() %}  {# 0=Mon, 1=Tue, ..., 6=Sun #}
            {% set day_names = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
            {% set day_name = day_names[wd] %}
            {% set day_active = is_state('input_boolean.heat_schedule_' + day_name + '_active', 'on') %}
            {% if not day_active %}
              false
            {% else %}
              {% set current_time = now().strftime('%H:%M:%S') %}
              {% set is_weekend = wd >= 5 %}  {# Saturday=5, Sunday=6 #}
              {% set is_friday = wd == 4 %}

              {# Determine which time periods to check based on day type #}
              {% if is_weekend %}
                {% set periods = [
                  ('weekend_period1', states('input_datetime.heat_weekend_period1_start'), states('input_datetime.heat_weekend_period1_end')),
                  ('weekend_period2', states('input_datetime.heat_weekend_period2_start'), states('input_datetime.heat_weekend_period2_end')),
                  ('weekend_period3', states('input_datetime.heat_weekend_period3_start'), states('input_datetime.heat_weekend_period3_end')),
                  ('weekend_period4', states('input_datetime.heat_weekend_period4_start'), states('input_datetime.heat_weekend_period4_end')),
                  ('weekend_period5', states('input_datetime.heat_weekend_period5_start'), states('input_datetime.heat_weekend_period5_end'))
                ] %}
              {% else %}
                {% if is_friday %}
                  {% set periods = [
                    ('weekday_period1', states('input_datetime.heat_weekday_period1_start'), states('input_datetime.heat_weekday_period1_end')),
                    ('weekday_period2', states('input_datetime.heat_weekday_period2_start'), states('input_datetime.heat_weekday_period2_end')),
                    ('weekday_period3', states('input_datetime.heat_weekday_period3_start'), states('input_datetime.heat_weekday_period3_end')),
                    ('weekday_period4', states('input_datetime.heat_weekday_period4_start'), states('input_datetime.heat_weekday_period4_end')),
                    ('friday_period5', states('input_datetime.heat_friday_period5_start'), states('input_datetime.heat_friday_period5_end')),
                    ('weekday_period6', states('input_datetime.heat_weekday_period6_start'), states('input_datetime.heat_weekday_period6_end'))
                  ] %}
                {% else %}
                  {% set periods = [
                    ('weekday_period1', states('input_datetime.heat_weekday_period1_start'), states('input_datetime.heat_weekday_period1_end')),
                    ('weekday_period2', states('input_datetime.heat_weekday_period2_start'), states('input_datetime.heat_weekday_period2_end')),
                    ('weekday_period3', states('input_datetime.heat_weekday_period3_start'), states('input_datetime.heat_weekday_period3_end')),
                    ('weekday_period4', states('input_datetime.heat_weekday_period4_start'), states('input_datetime.heat_weekday_period4_end')),
                    ('weekday_period5', states('input_datetime.heat_weekday_period5_start'), states('input_datetime.heat_weekday_period5_end')),
                    ('weekday_period6', states('input_datetime.heat_weekday_period6_start'), states('input_datetime.heat_weekday_period6_end'))
                  ] %}
                {% endif %}
              {% endif %}

              {# Check if current time falls within any period #}
              {% set ns = namespace(active=false) %}
              {% for period_name, start_time, end_time in periods %}
                {% if start_time != 'unknown' and end_time != 'unknown' %}
                  {% set s = today_at(start_time) %}
                  {% set e = today_at(end_time) %}
                  {% if e < s %}  {# Period crosses midnight #}
                    {% if now() >= s or now() < e %}
                      {% set ns.active = true %}
                    {% endif %}
                  {% else %}
                    {% if now() >= s and now() < e %}
                      {% set ns.active = true %}
                    {% endif %}
                  {% endif %}
                {% endif %}
              {% endfor %}
              {{ ns.active }}
            {% endif %}
          {% endif %}
        icon: mdi:clock-check

  - sensor:
      - name: "Current Heat Schedule Period"
        unique_id: current_heat_schedule_period
        state: >
          {% set enabled = is_state('input_boolean.heat_schedule_enabled', 'on') %}
          {% if not enabled %}
            "Schedule Disabled"
          {% else %}
            {% set wd = now().weekday() %}  {# 0=Mon, 1=Tue, ..., 6=Sun #}
            {% set day_names = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
            {% set day_name = day_names[wd] %}
            {% set day_active = is_state('input_boolean.heat_schedule_' + day_name + '_active', 'on') %}
            {% if not day_active %}
              "Day Inactive"
            {% else %}
              {% set current_time = now().strftime('%H:%M:%S') %}
              {% set is_weekend = wd >= 5 %}  {# Saturday=5, Sunday=6 #}
              {% set is_friday = wd == 4 %}

              {# Determine which time periods to check based on day type #}
              {% if is_weekend %}
                {% set periods = [
                  ('Weekend Period 1', states('input_datetime.heat_weekend_period1_start'), states('input_datetime.heat_weekend_period1_end')),
                  ('Weekend Period 2', states('input_datetime.heat_weekend_period2_start'), states('input_datetime.heat_weekend_period2_end')),
                  ('Weekend Period 3', states('input_datetime.heat_weekend_period3_start'), states('input_datetime.heat_weekend_period3_end')),
                  ('Weekend Period 4', states('input_datetime.heat_weekend_period4_start'), states('input_datetime.heat_weekend_period4_end')),
                  ('Weekend Period 5', states('input_datetime.heat_weekend_period5_start'), states('input_datetime.heat_weekend_period5_end'))
                ] %}
              {% else %}
                {% if is_friday %}
                  {% set periods = [
                    ('Weekday Period 1', states('input_datetime.heat_weekday_period1_start'), states('input_datetime.heat_weekday_period1_end')),
                    ('Weekday Period 2', states('input_datetime.heat_weekday_period2_start'), states('input_datetime.heat_weekday_period2_end')),
                    ('Weekday Period 3', states('input_datetime.heat_weekday_period3_start'), states('input_datetime.heat_weekday_period3_end')),
                    ('Weekday Period 4', states('input_datetime.heat_weekday_period4_start'), states('input_datetime.heat_weekday_period4_end')),
                    ('Friday Period 5', states('input_datetime.heat_friday_period5_start'), states('input_datetime.heat_friday_period5_end')),
                    ('Weekday Period 6', states('input_datetime.heat_weekday_period6_start'), states('input_datetime.heat_weekday_period6_end'))
                  ] %}
                {% else %}
                  {% set periods = [
                    ('Weekday Period 1', states('input_datetime.heat_weekday_period1_start'), states('input_datetime.heat_weekday_period1_end')),
                    ('Weekday Period 2', states('input_datetime.heat_weekday_period2_start'), states('input_datetime.heat_weekday_period2_end')),
                    ('Weekday Period 3', states('input_datetime.heat_weekday_period3_start'), states('input_datetime.heat_weekday_period3_end')),
                    ('Weekday Period 4', states('input_datetime.heat_weekday_period4_start'), states('input_datetime.heat_weekday_period4_end')),
                    ('Weekday Period 5', states('input_datetime.heat_weekday_period5_start'), states('input_datetime.heat_weekday_period5_end')),
                    ('Weekday Period 6', states('input_datetime.heat_weekday_period6_start'), states('input_datetime.heat_weekday_period6_end'))
                  ] %}
                {% endif %}
              {% endif %}

              {# Find which period we're currently in #}
              {% set ns = namespace(current_period='Outside Schedule') %}
              {% for period_name, start_time, end_time in periods %}
                {% if start_time != 'unknown' and end_time != 'unknown' %}
                  {% set s = today_at(start_time) %}
                  {% set e = today_at(end_time) %}
                  {% if e < s %}  {# Period crosses midnight #}
                    {% if now() >= s or now() < e %}
                      {% set ns.current_period = period_name + ' (' + start_time + ' - ' + end_time + ')' %}
                    {% endif %}
                  {% else %}
                    {% if now() >= s and now() < e %}
                      {% set ns.current_period = period_name + ' (' + start_time + ' - ' + end_time + ')' %}
                    {% endif %}
                  {% endif %}
                {% endif %}
              {% endfor %}
              {{ ns.current_period }}
            {% endif %}
          {% endif %}
        icon: mdi:clock-outline

# =============================================================================
# SETUP NOTES:
# 1. Copy this entire content to your configuration.yaml
# 2. Restart Home Assistant or reload YAML configuration
# 3. All input helpers will be created with your current schedule values
# 4. You can now modify the heizplan card to use these input helpers instead
# 5. The template sensors will show current schedule status
# =============================================================================